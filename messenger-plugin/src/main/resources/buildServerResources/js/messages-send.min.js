(function(a){var d={dialog:function(c,b){a("#messages-send-dialog-text").text(c);a("#messages-send-dialog").dialog({height:40,width:180,close:d.dialogClose});b>0&&d.dialogClose.delay(b)},dialogClose:function(){a("#messages-send-dialog").dialog("destroy");a("#messages-send-button").enable()}};a(function(){a("#messages-send-message").focus();a("#messages-send-dialog-ok").click(function(){d.dialogClose();return!1});a("#messages-send-all").change(function(){a("#messages-send-groups, #messages-send-users").disable(this.value==
"on")});a("#messages-send-all").click().change();a("#messages-send-form").submit(function(){var c=!1,b=a.trim(a("#messages-send-longevity-number").val());if(b.length&&(b=parseFloat(b),isNaN(b)||b<=0))a("#messages-send-longevity-number").addClass("errorField"),a("#messages-send-error-longevity").text("Message longevity should be a positive number"),c=!0;c||(a("#messages-send-longevity-number").removeClass("errorField"),a("#messages-send-error-longevity").text(""));a.trim(a("#messages-send-message").val())?
(a("#messages-send-message").removeClass("errorField"),a("#messages-send-error-message").text("")):(a("#messages-send-message").addClass("errorField"),a("#messages-send-error-message").text("Message should be specified"),c=!0);a("#messages-send-all").attr("checked")||a("#messages-send-groups").val()||a("#messages-send-users").val()?a("#messages-send-error-selection").text(""):(a("#messages-send-error-selection").text("Recipients should be selected"),c=!0);c||(a("#messages-send-button").disable(),
a("#messages-send-progress").show(),a.ajax({url:this.action,type:"POST",data:a(this).serialize(),dataType:"text",success:function(b){d.dialog('Message "'+b+'" sent',1);a("#messages-send-message").val("").focus()},error:function(){d.dialog("Failed to send message",-1);a("#messages-send-message").focus()},complete:function(){a("#messages-send-progress").hide()}}));return!1})})})(jQuery);