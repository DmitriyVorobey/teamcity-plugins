(function(a){var b={dialog:function(c,d){a("#messages-send-dialog-text").text(c);a("#messages-send-dialog").dialog({height:40,width:180,close:b.dialogClose});d>0&&b.dialogClose.delay(d)},dialogClose:function(){a("#messages-send-dialog").dialog("destroy");a("#messages-send-message").val("").focus();a("#messages-send-button").enable()}};a(function(){a("#messages-send-message").focus();a("#messages-send-dialog-ok").click(function(){b.dialogClose();return!1});a("#messages-send-all").change(function(){a("#messages-send-groups, #messages-send-users").disable(this.value==
"on")});a("#messages-send-all").click().change();a("#messages-send-form").submit(function(){var c=parseInt(a.trim(a("#messages-send-longevity-number").val()));if(isNaN(c)||c<1)return a("#messages-send-longevity-number").addClass("errorField"),a("#messages-send-error-longevity").text("'Valid For' should be a positive number"),!1;else a("#messages-send-longevity-number").removeClass("errorField"),a("#messages-send-error-longevity").text("");if(a.trim(a("#messages-send-message").val()))a("#messages-send-message").removeClass("errorField"),
a("#messages-send-error-message").text("");else return a("#messages-send-message").addClass("errorField"),a("#messages-send-error-message").text("Message can't be empty"),!1;if(a("#messages-send-all").attr("checked")||a("#messages-send-groups").val()||a("#messages-send-users").val())a("#messages-send-error-selection").text("");else return a("#messages-send-error-selection").text("Recipients should be selected"),!1;a("#messages-send-button").disable();a("#messages-send-progress").show();a.ajax({url:this.action,
type:"POST",data:a(this).serialize(),dataType:"text",success:function(a){b.dialog('Message "'+a+'" sent',1)},error:function(){b.dialog("Failed to send message",-1)},complete:function(){a("#messages-send-progress").hide()}});return!1})})})(jQuery);